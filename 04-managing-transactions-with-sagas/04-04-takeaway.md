# ü§ù 04-04-Takeaway

* Alcune operazioni di sistema necessitano di _aggiornare_ dati dispersi su pi√π servizi. Le transazioni distribuite tradizionali basate su XA/2PC non sono adatte alle applicazioni moderne. Un approccio migliore √® utilizzare il _pattern Saga_. Una saga √® una sequenza di transazioni locali coordinate tramite messaggistica. Ogni transazione locale aggiorna i dati in un singolo servizio. Poich√© ogni transazione locale conferma le sue modifiche, se una saga deve essere annullata a causa della violazione di una regola aziendale, √® necessario eseguire transazioni compensative per annullare esplicitamente le modifiche.
* Puoi utilizzare sia la coreografia che l'orchestrazione per coordinare i passaggi di una saga. In una saga basata su coreografia, una transazione locale pubblica eventi che attivano altri partecipanti per eseguire transazioni locali. In una saga basata su orchestrazione, un orchestratore di saga centralizzato invia messaggi di comando ai partecipanti dicendo loro di eseguire transazioni locali. Puoi semplificare lo sviluppo e il test modellando gli orchestratori di saga come macchine a stati. Le saghe semplici possono utilizzare la coreografia, ma l'orchestrazione √® di solito un approccio migliore per le saghe complesse.
* Progettare la logica di business basata su saghe pu√≤ essere impegnativo perch√©, a differenza delle transazioni ACID, le saghe non sono isolate l'una dall'altra. Spesso √® necessario utilizzare contromisure, che sono strategie di progettazione che prevengono anomalie di concorrenza causate dal modello di transazione ACD. Un'applicazione potrebbe persino aver bisogno di utilizzare il blocco per semplificare la logica aziendale, anche se ci√≤ comporta il rischio di deadlock.
